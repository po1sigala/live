# 12.2 Part-Time Lesson Plan: Node

## Overview 

In today's class, students will connect a MySQL database to a Node.js application and develop a database schema using various data types and foreign and primary keys. Seeding a database is also discussed. 

## Instructor Notes

* In this lesson, students will complete activities `11-Ins_Connect-Node` through `20-Stu_Foreign-Primary-Key`.

* After starting the MySQL server, make sure that students can initialize the MySQL command-line prompt, using the command `mysql -uroot -p`. They will need their MySQL password.

  * If macOS users get the error message `command not found`, they might need to add the following into their `.bash_profile` or `.zshrc` file:
 
    `export PATH="${PATH}:/usr/local/mysql/bin/"`

  * If Windows users get the `command not found` error, refer them to the [MySQL documentation on customizing the PATH](https://dev.mysql.com/doc/mysql-windows-excerpt/5.7/en/mysql-installation-windows-path.html).

* In today's Stoking Curiosity, you will use MySQL's sample employee database to demonstrate to the students the real-world application of SQL. Prior to class, be sure to [download the sample database](https://dev.mysql.com/doc/employee/en/) and unzip it. You can also [download it directly from the GitHub repo](https://github.com/datacharmer/test_db).

* The instructions for the Stoking Curiosity aim to reinforce the skills the students learn in class and avoid a possible permissions error during installation of the MySQL sample database. Please review the provided instructions prior to class since they differ from those provided in the database's GitHub repo.

* Remind students to do a `git pull` of the class repo to have today's activities ready and open in VS Code. 

* If you are comfortable doing so, live-code the solutions to the activities. If not, just use the solutions provided and follow the prompts and talking points for review.

* Let students know that the Bonus at the end of each activity is not meant to be extra coding practice, but instead is a self-study on topics beyond the scope of this unit for those who want to further their knowledge.

## Learning Objectives

By the end of class, students will be able to:

* Configure a Node.js application to connect to a MySQL database.

* Use data types to specify the type of data each column can hold

* Create a database schema

* Seed a database for use in application development

* Specify the relationship between tables using primary and foreign keys.

## Time Tracker

| Start  | #   | Activity Name                         | Duration |
|---     |---  |---                                    |---       |
| 6:30PM | 1   | Instructor Do: Stoke Curiosity        | 0:10     |
| 6:40PM | 2   | Instructor Demo: Connect to Node      | 0:05     |
| 6:45PM | 3   | Student Do: Connect to Node           | 0:15     |
| 7:00PM | 4   | Instructor Review: Connect to Node    | 0:10     |
| 7:10PM | 5   | Instructor Demo: Data Types           | 0:05     |
| 7:15PM | 6   | Student Do: Data Types                | 0:15     |
| 7:30PM | 7   | Instructor Review: Data Types         | 0:10     |
| 7:40PM | 8   | Instructor Demo: Schema               | 0:05     |
| 7:45PM | 9   | Student Do: Schema                    | 0:15     |
| 8:00PM | 10  | BREAK                                 | 0:15     |
| 8:15PM | 11  | Instructor Review: Schema             | 0:10     |
| 8:25PM | 12  | Instructor Demo:  Seeds               | 0:05     |
| 8:30PM | 13  | Student Do: Seeds                     | 0:15     |
| 8:45PM | 14  | Instructor Review: Seeds              | 0:10     |
| 8:55PM | 15  | Instructor Demo: Keys                 | 0:05     |
| 9:00PM | 16  | Student Do: Keys                      | 0:15     |
| 9:15PM | 17  | Instructor Review: Keys               | 0:15     |
| 9:30PM | 18  | END                                   | 0:00     |

> **Important**: If this lesson occurs on a Saturday, make sure to adjust the activities to accommodate for the extra hour of class time. Feel free to take your time as you go through the activities; for example, you can add 5 minutes to the `Student Do` and `Instructor Review` sections as you see fit. Remember to take a 40-minute break at noon!

---

## Class Instruction

### 1. Instructor Do: Stoke Curiosity (10 min)

* Welcome students to class.

* If you have not yet downloaded the MySQL Sample Database, [download the database here](https://dev.mysql.com/doc/employee/en/employees-installation.html) and unzip it. You can also [download it directly from the GitHub repo](https://github.com/datacharmer/test_db).

* Inform the students that while we are working with relatively small sets of data in our activities, in the real-world, SQL is used by many companies to handle large amounts of data quickly and easily.

* Stress to the students that the skills we are learning in class are the same skills used on the job to handle large datasets in the workplace, making SQL a highly transferable skill. 

* Open the `test_db/employees.sql` directory in your IDE to demonstrate the following:

  * MySQL provides a sample database that we can use to practice querying large amounts of data similar to datasets found in the workplace.
  
  * Just like the databases we created in class, the sample database uses the `CREATE` and `USE` commands to create and select the database.

    ```sql
    DROP DATABASE IF EXISTS employees;
    CREATE DATABASE IF NOT EXISTS employees;
    USE employees; 
    ```

  * The sample database is also made up of a number of tables to hold the data. For each column in the `employees` table, for example, a specific type of data is assigned. There is also a primary key. During class today we will learn more about applying data types and keys to our own tables. 

    ```sql
    CREATE TABLE employees (
      emp_no      INT             NOT NULL,
      birth_date  DATE            NOT NULL,
      first_name  VARCHAR(14)     NOT NULL,
      last_name   VARCHAR(16)     NOT NULL,
      gender      ENUM ('M','F')  NOT NULL,    
      hire_date   DATE            NOT NULL,
      PRIMARY KEY (emp_no)
    );
    ```

  * The description of the database and tables make up the dataset's schema. As your datasets grow, we must plan out our schema to define both the types of data that each table can hold as well as the relationship between the tables. 

* Open [Employees Schema for MySQL Sample Database](https://dev.mysql.com/doc/employee/en/sakila-structure.html) in your browser to demonstrate the following:

  * Databases large and small use schemas to define the structure of each table. 

 * We see the employees table in this diagram. We can also see the the employees table is linked to number of other tables. These relationships allow us to query to return meaningful data while keeping the data organized. 


* Navigate to `test_db` directory in your command line  to demonstrate the following:
   
  * After downloading the dataset, we navigate to the unpacked directory to work with it using the MySQL Shell. 

    ```sh
    cd test_db/
    mysql -uroot -p
    ```

  * In the MySQL Shell, we use the `SOURCE` command to execute the `employees.sql` file.

    ```sql
    SOURCE employees.sql;
    ```

  * To check to make sure our employees database is now in use, we enter `SELECT DATABASE()`.

    ```sql
    SELECT DATABASE();
    ```

  * Now, let's take a look at the tables contained in our database using `SHOW TABLES`.

    ```sql
    SHOW TABLES;
    ```

  * To see how big the database is, we can use a new method -- the aggregate function `COUNT` --  to return the number of rows in the `employees` table. 

    ```sql
    SELECT COUNT(*) FROM employees;
    ```

  * There are over 300,000 employees in the database! 

* As developers, it is important that we build our databases to easily scale to work quickly and easily whether the tables contain ten rows or 300,000. In today's class, we will focus on the tools needed to build databases, provide our own practice data for development and connect our databases to a MySQL server. 

### 2. Instructor Demo: Connect to Node (5 min) 

* Navigate to `11-Ins_Connect-Node/db` in your command line and enter `mysql -uroot -p` to enter the MySQL Shell.

* Run `SOURCE schema.sql;` and `SOURCE seeds.sql;` to create and seed the database. 

* Navigate to `11-Ins_Connect-Node/` and run `npm install` to demonstrate the following:

  * So far, we have been working with MySQL using the MySQL Shell. However, we often want to access data and manipulate our data using an app. To do so, we can connect a MySQL database to an Express.js server.

  * When we open the server file using `node server.js`, data is printed to the command line. This data is the result of a query run directly in our Express server.

    ```sh
    node server.js
    ```
* Open `11-Ins-Connect-Node/server.js` in the IDE to demonstrate the following:

  * 🔑 We use the `mysql2` NPM package to easily connect our MySQL database to our Express server.

    ```js
    const mysql = require('mysql2');
    ```
  
  * 🔑 Once we have required `mysql2`, we create a new database instance using `CreateConnection().

    ```js
    const db = mysql.createConnection();
    ```

  * 🔑 We also specify the host, user, password, and database. These configurations should match the way you access the database using the MySQL Shell. 

    ```js
    {
      host: 'localhost',
      user: 'root',
      password: '',
      database: 'classlist_db'
    },
    ```

  * 🔑 Now, that we are connected to the database, we can query the database directly in Express using the `query()` function. 

    ```js
    db.query()
    ```

  * The query function takes two parameters. The first is the actual query we want to execute and the second is the function we want performed. Note that the query looks exactly the same as it did when we queried using the MySQL Shell. 

    ```js
    db.query('SELECT * FROM students', function (err, results) {
      console.log(results);
    });
    ```

  * When we run the `server.js` file,  the query is executed and the data is printed to the screen. 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ What steps do we take to connect a MySQL database to an Express server?

  * 🙋 We require the `mysql2` NPM package. Then, we use `CreateConnection()` to connect our MySQL database to Express.

* Answer any questions before proceeding to the next activity.

* In preparation for the activity, ask TAs to start directing students to the activity instructions found in `12-Stu_Connect-Node/README.md`.

### 3. Student Do: Connect to Node (15 min) 

* Direct students to the activity instructions found in `12-Stu_Connect-Node/README.md`.

* Break your students into pairs that will work together on this activity.

  ```md
  # 📐 Add Comments to Implementation of MySQL in Node.js Environment

  Work with a partner to add comments describing the functionality of the code found in [server.js](./Unsolved/server.js).

  ## 📝 Notes

  Refer to the documentation: 

  [NPM documentation on Node MySQL 2](https://www.npmjs.com/package/mysql2#installation)

  ---

  ## 🏆 Bonus

  If you have completed this activity, work through the following challenge with your partner to further your knowledge:

  * How are we able to interact with MySQL in our Node application?

  Use [Google](https://www.google.com) or another search engine to research this.  
  ```

* While breaking everyone into groups, be sure to remind students and the rest of the instructional staff that questions on Slack or otherwise are welcome and will be handled. It's a good way for your team to prioritize students who need extra help.

### 4. Instructor Review: Connect to Node (10 min) 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ How comfortable do you feel with Connecting to Node? (Poll via Fist to Five, Slack, or Zoom)

* Assure students that we will cover the solution to help solidify their understanding. If questions remain, remind them to use office hours to get extra help!

* Use the prompts and talking points (🔑) below to review the following key points:

  * ✔️ require('mysql2')

  * ✔️ createConnection()

  * ✔️ query()

* Navigate to `12-Stu_Connect-Node/Solved/db` in your command line.

  * When we use the MySQL Shell, we set our user using `-u` and the `-p` password flag to enter our password. Our user is set to `root` and we use our MySQL password. We will need this information when we connect our database to our Express server. 

    ```sql
    mysql -uroot -p
    ```

  * To create our database and provide seed data, we execute the `schema.sql` file and the `seeds.sql` files in the MySQL Shell.

    ```sql
    SOURCE schema.sql;
    SOURCE seeds.sql;
    ```

  * To see the database currently in use, we use the `SELECT DATABASE()` command. We  use this exact name to connect our database to our Express server. 

    ```sql
    SELECT DATABASE();
    ```

* Open `12-Stu_Connect-Node/Solved/server.js` in your IDE and explain the following: 

  * 🔑 We require the `mysql2` NPM package to connect our database to our server.

    ```js
    const mysql = require('mysql2');
    ```

  * 🔑 We then use the `mysql2` method `createConnection()` to create a new instance of a MySQL database and store the connection in a variable named `db`. 

    ```js
    const db = mysql.createConnection()
    ```

  * 🔑 To connect to the database we just created using the MySQL Shell, we add the information needed including the user, the password, and the name of the database. This information should match exactly. 

    ```js
    const db = mysql.createConnection(
     {
       host: 'localhost',
       user: 'root',
       password: '',
       database: 'classlist_db'
      },
      console.log(`Connected to the classlist_db database.`)
    );
    ```

  * 🔑 To test that the database has been successfully connected, we call the `query()` method on our new database instance. The method takes in two parameters: the query we want to execute and the function we want performed.

    ```js
    db.query('SELECT * FROM students', function (err, results) {
      console.log(results);
    });
    ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ How can we execute a MySQL query in an Express server? 

  * 🙋 We use the `query()` method. The first parameter is the query -- written just as we would enter into MySQL Shell -- and the second is the action we want performed. 

  * ☝️ What can we do if we don't completely understand this?

  * 🙋 We can refer to supplemental material, read the [MySQL2 documentation on installation](https://www.npmjs.com/package/mysql2), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.

### 5. Instructor Demo: Data Types (5 min) 

* Open `13-Ins_Data-Types/db/schema.sql` in your IDE and explain the following:

  * When we create a database that we can scale to include a large amount of data, we want to make sure that the data that we are storing is useful and the right type. 

  * 🔑 We use the Data Type attribute to assign specific types of data to our columns and limit the types of data that a column can hold. 

  * 🔑 We use the `INT` or `INTEGER` data type to store whole numbers. 

    ```sql
    id INT
    ```
  * 🔑 For strings, we use `VARCHAR` for shorter strings of text and provide a number of characters allowed. For longer strings of indeterminate length, we use `TEXT`.

    ```sql
    course_title VARCHAR(30),
    course_description TEXT,
    ```

  * 🔑 For values that are true or false, we use the `BOOLEAN` data type. 

    ```sql
    active BOOLEAN 
    ```

  * 🔑 For each of these common data types, we have also added the `NOT NULL` constraint. We use `NOT NULL` when we want to require that each row of the table has data for that particular column. 

    ```sql
    id INT NOT NULL,
    course_title VARCHAR(30) NOT NULL,
    course_description TEXT NOT NULL,
    active BOOLEAN NOT NULL,
    ```

  * We can also set a column to automatically generate data, like a date. 

    ```sql
    date_updated DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL
    ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ Why do we add a data type attribute to our columns?

  * 🙋 We add a data type attribute to limit the type of data that the column can store. This is important to help make sure only useful data is stored in our database. 

* Answer any questions before proceeding to the next activity.

* In preparation for the activity, ask TAs to start directing students to the activity instructions found in `14-Stu_Data-Types/README.md`.

### 6. Student Do: Data Types (15 min) 

* Direct students to the activity instructions found in `14-Stu_Data-Types/README.md`.

* Break your students into pairs that will work together on this activity.

  ```md
  # 📖 Implement Data Types and Constraints 

  Work with a partner to implement the following user story:

  * As a developer, I want to add data types and constraints to my table.

  ## Acceptance Criteria

  * It's done when each column in the `customers` table has a defined data type and constraint.

  * It's done when the values in the `id`, `first_name` and `last_name` columns cannot be `NULL`.

  ## 📝 Notes

  Refer to the documentation: 

  [MySQL Docs on Data Types](https://dev.mysql.com/doc/refman/8.0/en/data-types.html)

  ## 💡 Hints

  If no value is supplied to a column, what value is set by default? 

  ## 🏆 Bonus

  If you have completed this activity, work through the following challenge with your partner to further your knowledge:

  * Why would we want to add constraints to our table?

  Use [Google](https://www.google.com) or another search engine to research this.
  
  ```

* While breaking everyone into groups, be sure to remind students and the rest of the instructional staff that questions on Slack or otherwise are welcome and will be handled. It's a good way for your team to prioritize students who need extra help.

### 7. Instructor Review: Data Types (10 min) 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ How comfortable do you feel with data types and constraints? (Poll via Fist to Five, Slack, or Zoom)

* Assure students that we will cover the solution to help solidify their understanding. If questions remain, remind them to use office hours to get extra help!

* Use the prompts and talking points (🔑) below to review the following key points:

   * ✔️ `INT`

   * ✔️ `VARCHAR()`

   * ✔️ `NOT NULL`

   * ✔️ `BOOLEAN`

* Open `14-Stu_Data-Types/Solved/db/schema.sql` in your IDE and explain the following: 

    * 🔑 When we create columns for a table, it is important to properly define the columns using data types. For an ID, we use `INT` or `INTEGER` to allow only whole numbers.
  
      ```sql
      id INT
      ```

    * 🔑 When we want to add string values to the column, we want to limit the column only to the size that we need. By setting the column to `VARCHAR(30)` we allow names up to 30 characters. 
  
      ```sql
      first_name VARCHAR(30),
      last_name VARCHAR(30),
      );
      ```

    * 🔑 For data that we can express as `True` or `False` we use a boolean. MySQL does not  have a built-in `Boolean` so using `Boolean` is a synonym for using `TinyInt(1)`. The `TinyInt(1)` has a two values: the `0` is read as false while the `1` is read as true. When you read a table that has a column with a `Boolean` data type, the data will appear as `O`s and `1`s. 

      ```sql
      value_card_member BOOLEAN   
      ```

    * 🔑 In addition to data types, we use constraints to further limit our data. The `NOT NULL` constraint is used to make sure each row has a value for that column and no `null` values are allowed.

      ```sql
      id INT NOT NULL,
      first_name VARCHAR(30) NOT NULL,
      last_name VARCHAR(30) NOT NULL,
      value_card_member BOOLEAN NOT NULL
      ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ Why is it important to select the right data type and constraints for each column? 

    * 🙋 Using the data types, we can determine the type of data each column can hold as well as the amount of space each piece of data is allowed to take up. We use constraints to further define rules for each column. This helps enforce the integrity of the database. 

  * ☝️ What can we do if we don't completely understand this?

  * 🙋 We can refer to supplemental material, read the read the [MySQL documentation on data types](https://dev.mysql.com/doc/refman/8.0/en/data-types.html), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.

### 8. Instructor Demo: Schemas (5 min) 

* Open `15-Ins_Schema/index.html` in your browser and demonstrate the following:

  * Schema design is an important step in developing a database that can efficiently handle datasets of all sizes.

  * 🔑 When planning a database, it is important to think of the type of data you will be storing and how the data is related. For example, for our `registrar_db` database, our data falls into four categories: courses, students, instructors, and classrooms.

  * 🔑 Next, it is time to get a bit more granular. For every table, we want to have a unique way to identify a row of data. That is usually the `id`. Then, each column should represent a single piece of data that can be easily defined by a single data type. 

  * Once the planning is done, it is time for us to actually create the database and tables. 

* Open `15-Ins_Schema/db/schema.sql;` in your browser and demonstrate the following:

  * 🔑 We start our schema by creating and selecting the database. 

    ```sql
    DROP DATABASE IF EXISTS registrar_db;
    CREATE DATABASE registrar_db;
    USE registrar_db;
    ```

  * 🔑 Next, we check to see if the table exists, and if so, drop it. Then, we create a new table using `CREATE TABLE`.

    ```sql
    DROP TABLE IF EXISTS courses;
    CREATE TABLE courses () 
    ```

  * 🔑 For each table we create, we add an `id` column followed by additional columns that hold our data. For each column, we add a data type and constraints, as needed.

    ```sql
    DROP TABLE IF EXISTS students;
    CREATE TABLE students (
      id INT NOT NULL,
      first_name VARCHAR(30) NOT NULL,
      last_name VARCHAR(30) NOT NULL,
      active BOOLEAN NOT NULL,
      date_updated DATETIME DEFAULT CURRENT_TIMESTAMP NOT NULL
    );
    ```

* Navigate to `15-Ins_Schema/db` in your command line and enter `mysql -uroot -p` to enter the MySQL Shell to demonstrate the following:

    * To execute our schema, we use the `SOURCE` command.

      ```sql
      SOURCE schema.sql;
      ```

    * We use the `DESCRIBE` command in the MySQL Shell to view the table and the data type for each column. 

      ```sql
      DESCRIBE students;
      ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ Why do we include an `id` in each table?

  * 🙋 The `id` provides a unique identifier for each row of data to make it easier to work with our data. 

* Answer any questions before proceeding to the next activity.

* In preparation for the activity, ask TAs to start directing students to the activity instructions found in `16-Stu_Schema/README.md`.

### 9. Student Do: Schema (15 min) 

* Direct students to the activity instructions found in `16-Stu_Schema/README.md`.

* Break your students into pairs that will work together on this activity.

  ```md
  # 🏗️ Design Schema With Tables

  Work with a partner to implement the following user story:

  * As a developer, I want to design a schema that contains two tables. 

  ## Acceptance Criteria

  * It's done when the schema includes two tables.

  * It's done when each table has three columns and each column has a defined data type and constraint.

  * It's done when the schema matches the diagram below.

  ## Assets

  The following image demonstrates the web application's appearance and functionality:

  ![Schema diagram](./assets/image_1.png)

  ---

  ## 💡 Hints

  * What MySQL command do we use to display a table and information about each field's data types? 

  ## 🏆 Bonus

  If you have completed this activity, work through the following challenge with your partner to further your knowledge:

* What are some issues we can avoid by having a well designed schema?

  Use [Google](https://www.google.com) or another search engine to research this.
  
  ```

* While breaking everyone into groups, be sure to remind students and the rest of the instructional staff that questions on Slack or otherwise are welcome and will be handled. It's a good way for your team to prioritize students who need extra help.

### 10. BREAK (15 min)

### 11. Instructor Review: Schema (10 min) 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ How comfortable do you feel with designing a schema? (Poll via Fist to Five, Slack, or Zoom)

* Assure students that we will cover the solution to help solidify their understanding. If questions remain, remind them to use office hours to get extra help!

* Use the prompts and talking points below to review the following key (🔑) points:

    * ✔️ `CREATE DATABASE`

    * ✔️ `USE` command

    * ✔️ `CREATE TABLE`

    * ✔️ Data types

    * ✔️ `NOT NULL`

    * ✔️ `DESCRIBE`

* Open `16-Stu_Schema/Solved/db/schema.sql` in your IDE and explain the following: 

   * 🔑 We check if the database exists, and, if so, drop it. Then, we create our database using the `CREATE DATABASE` command.

     ```sql
     DROP DATABASE IF EXISTS grocery_db;
    CREATE DATABASE grocery_db; 
     ```
    
    * 🔑 We use the `USE` command to specify which database the tables will be added to:

      ```sql
      USE grocery_db;
      ```

    * 🔑 We use the `CREATE` command to add a new table. 
  
      ```sql
      CREATE TABLE products(
      );
      ```

    * 🔑 We add an `id` column to our table and set it to  `NOT NULL`, so the column must always contain a value. We also add columns that hold a specific type of data that we need to store in our database. 
  
      ```sql
      CREATE TABLE products(
        id INT NOT NULL,
        product_name VARCHAR(30) NOT NULL,
        category_name VARCHAR(100) NOT NULL,
        price INT NOT NULL,
        in_stock BOOLEAN
      );
      ```

    * 🔑 We use the `CREATE` command to add a second table and assign a data type to each column. 

      ```sql
      CREATE TABLE categories(
        id INT NOT NULL,
        category_name VARCHAR(30) NOT NULL
      );    
      ```

* Navigate to `16-Stu_Schema/Solved/db` in your command line and enter `mysql -uroot -p` to enter the MySQL Shell to demonstrate the following:

    * To execute our schema, we use the `SOURCE` command.

      ```sql
      SOURCE schema.sql;
      ```

    * 🔑 We use the `DESCRIBE` command in the MySQL Shell to test that the new tables have been successfully created and have the right data types:

      ```sql
      DESCRIBE products;
      DESCRIBE categories;
      ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ Why do we drop the `grocery_db` database if it exists?

    * 🙋 We use the `DROP` command before adding a new database so that we can start fresh. If a database is already named `grocery_db`, it will be dropped first. Then we can add the new database without error. 

    * ☝️ Why do we need a schema?

    * 🙋 A schema describes the data that we want to store in the database and serves as a template for the tables. 

    * ☝️ What can we do if we don't completely understand this?

    * 🙋 We can refer to the lesson plan, read the [MySQL documentation on schemas](https://dev.mysql.com/doc/refman/8.0/en/getting-information.html), and stay for Office Hours to ask for help.

* Answer any questions before proceeding to the next activity.

### 12. Instructor Demo: Seeds (5 min) 

* Navigate to `17-Ins_Seeds/db` in your command line and enter `mysql -uroot -p` to enter the MySQL Shell to demonstrate the following:

  * After we initialize the MySQL Shell, we set up the database by typing `source schema.sql`.

    ```sql
    SOURCE schema.sql;
    ```

  * 🔑 This schema provides the blueprint for our data. To work with our data during development, we will need to add some data. To do that, we use a `seeds` file. 

  * 🔑 Once the seeds are created, we import our data into our database, using the `SOURCE` command.

    ```sql
    SOURCE seeds.sql
    ```

  * We can then query the data using `SELECT *` to see all the data added to the `courses` table. 

    ```sql
    SELECT * FROM courses;
    ```

* Open `17-Ins_Seeds/db/seeds.sql` in your IDE and explain the following: 

  * 🔑 To create a seeds file, we use an `INSERT INTO` command to specify the table that we want to add data to and the columns.

    ```sql
    INSERT INTO courses (id, course_title, course_description, active)
    ```

  * 🔑 We then use a `VALUES` clause to specify the values. These values will provide seeds, or sample data, that we can work with during development. We can also use seeds to provide static values, like country codes, that may be used in both development and in production. 

    ```sql
    VALUES (001, "Algebra I", "Linear equations, inequalities, functions, and graphs", true),
       (002, "Pre-Calculus", "Polynomials, Complex Numbers, Vectors", true),
       (003, "Calculus I", "Limits, Differentiation, Derivatives", true),
       (004, "Euclidean Geometry", "Intuitively Appealing Axioms Galore", false);
    ```

  * ☝️ Why do we use seeds to provide sample data during development? 

  * 🙋 We provide seeds, or sample data, during development to give a set of data used to test our schema design and queries. 

* Answer any questions before proceeding to the next activity.

* In preparation for the activity, ask TAs to start directing students to the activity instructions found in `18-Stu_Seeds/README.md`.

### 13. Student Do: Seeds (15 min)

* Direct students to the activity instructions found in `18-Stu_Seeds/README.md`

* Break your students into pairs that will work together on this activity.

  ```md
  # 🐛 Seed Data Not Populating Table

  Work with a partner to resolve the following issue(s):

  * As a developer, I should be able to populate my table with seed data.

  ## Expected Behavior

  When the `seed.sql` file is executed in the MySQL Shell, the data should populate my table.

  ## Actual Behavior

  When the `seed.sql` file is executed, the data is not successfully populated in the table. 

  ## Steps to Reproduce the Problem

  1. Execute `schema.sql` in MySQL Shell to create the database and table.

  2. Execute `seeds.sql` in MySQL Shell to populate data in the table. 

  3. Run command `SELECT * FROM products;` to view seeded data.

  ## Assets

  The following image demonstrates the web application's appearance and functionality:

  ![Image of Completed Table](./assets/image_1.png)

  ---

  ## 💡 Hints

  What MySQL statement do we use to add data to a table? 

  ## 🏆 Bonus

  How can you alter an existing table? 

  If you have completed this activity, work through the following challenge with your partner to further your knowledge:

  Use [Google](https://www.google.com) or another search engine to research this.
  
  ```

* While breaking everyone into groups, be sure to remind students and the rest of the instructional staff that questions on Slack or otherwise are welcome and will be handled. It's a good way for your team to prioritize students who need extra help.

### 14. Instructor Review: Seeds (10 min) 

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ How comfortable do you feel with seeding data? (Poll via Fist to Five, Slack, or Zoom)

* Assure students that we will cover the solution to help solidify their understanding. If questions remain, remind them to use office hours to get extra help!

* Use the prompts and talking points (🔑) below to review the following key points:

  * ✔️ `INSERT INTO`

  * ✔️ `VALUES`

* Open `18-Stu_Seeds/Solved/db/schema.sql` in your IDE and explain the following: 

   * 🔑 We start by looking at the table in our schema. The `products` table has three columns, all of which are set to `NOT NULL`. That means they must contain a value.

     ```sql
     CREATE TABLE products (
       id INT NOT NULL,
       product_name VARCHAR(30) NOT NULL,
      category_name VARCHAR(30) NOT NULL
     );
     ```

* Open `18-Stu_Seeds/Solved/db/seeds.sql` in your IDE and explain the following: 

   * 🔑 We use the `INSERT INTO` statement to specify which table we are adding data to and which columns they belong to. Since the `id` column is set to `NOT NULL`, we must provide a value. 

     ```sql
     INSERT INTO products (id, product_name, category_name)
     ```

  * 🔑 Then we use `VALUES` to insert values into the columns, separating each row with a comma, and making sure the seed data appears in the same order as the column list. 

    ```sql
    VALUES (001, "spinach", "produce"),
       (002, "peanut butter", "staples"),
       (003, "peas-canned", "canned goods"),
       (004, "ice cream", "frozen"),
       (005, "potato chips", "snacks");
    ```

* Navigate to `18-Stu_Seeds/Solved/db` in your command line and enter `mysql -uroot -p` to enter the MySQL Shell to demonstrate the following:

  * To execute our schema and seed our data, we use the `SOURCE` command.

    ```sql
    SOURCE schema.sql;
    SOURCE seeds.sql;
    ``` 

  * To test that our data has been successfully added, we use `SELECT *`.

    ```sql
    SELECT * FROM products;
    ```  

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

    * ☝️ What are the benefits of seeding a table?

    * 🙋 Seeding a table provides sample data that will allow us to test queries and interact with the database. We can also use seeding to populate a table where the data will not change, like country codes or zip codes. 

  * ☝️ What can we do if we don't completely understand this?

  * 🙋 We can refer to supplemental material, read the [MySQL documentation on loading data into a table](https://dev.mysql.com/doc/refman/8.0/en/loading-tables.html), and stick around for office hours to ask for help.

* Answer any questions before proceeding to the next activity.

### 15. Instructor Demo: Foreign and Primary Keys (5 min) 

* Open `19-Ins_Foreign-Primary-Key/index.html` in your browser and demonstrate the following:

  * Storing data in tables is useful but the power of a MySQL database comes from the ability to form relationships between groups of data. 

  * Our schema has two tables: instructors and courses. The instructor table holds the information for each individual instructor. The courses table holds the data needed for each course.

  * 🔑 Since each course has an instructor, we form a relationship to link the data between the two tables. 

  * 🔑 That relationship links the `id` of the instructor with the courses table using primary and foreign keys.

* Open `19-Ins_Foreign-Primary-Key/db/schema.sql` in your IDE and demonstrate the following:

  * 🔑 A primary key is a way to identify the rows of a table and must be unique and set to `NOT NULL`. In the instructors table, we set our `id` to be our primary key.

    ```sql
    CREATE TABLE instructors (
      id INT NOT NULL,
      first_name VARCHAR(30),
      last_name VARCHAR(30),
     PRIMARY KEY (id)
    );
    ```

  * 🔑 We then use the instructor's primary key to link to the courses table. 

  * 🔑 In our course table, we set a column that will hold the id and set it to contain the same type of data as the primary key we just set up. In this case, it is an `INT`. Unlike primary keys, a foreign key can contain null values. 

    ```sql
    instructor_id INT
    ```

  * 🔑 Then, we designate the column as a foreign key, or a column that refers to the primary key of another table.

    ```sql
    FOREIGN KEY (instructor_id)
    ```

  * 🔑 To define the relationship, we use `REFERENCES` followed by the name of the table and column we want to reference.

    ```sql
    REFERENCES instructors(id)
    ```

  * 🔑 Since the data is now related, we want a way to handle if data is deleted from the parent table. So if the instructor data is no longer available, the column will be set to NULL.

    ```sql
    ON DELETE SET NULL
    ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ How do we link tables using primary and foreign keys?

  * 🙋 We use a primary key to provide a unique identifier for each row of data in a table we want to reference. We then use a foreign key in a second table to make a link between the two tables. 

* Answer any questions before proceeding to the next activity.

* In preparation for the activity, ask TAs to start directing students to the activity instructions found in `20-Stu_Foreign-Primary-Key/README.md`.

### 16. Student Do: Foreign and Primary Keys (15 min) 

* Direct students to the activity instructions found in `20-Stu_Foreign-Primary-Key/README.md`.

* Break your students into pairs that will work together on this activity.

  ```md
  # 🏗️ Use Primary Key and Foreign Key to Define Relationship Between Tables

  Work with a partner to implement the following user story:

  * As a developer, I want to link two tables using a primary and foreign key.

  ## Acceptance Criteria

  * It's done when the `id` column the `customers` table is defined as the primary key.

  * It's done the foreign key in the `customer_orders` table refers to the `customers` table primary key.

  ## 💡 Hints

  * What is the difference between the primary and foreign key constraints?

  ## 🏆 Bonus

  If you have completed this activity, work through the following challenge with your partner to further your knowledge:

  * What are the advantages of using multiple, related tables to store our data? 

  Use [Google](https://www.google.com) or another search engine to research this.

  ---
  ```

* While breaking everyone into groups, be sure to remind students and the rest of the instructional staff that questions on Slack or otherwise are welcome and will be handled. It's a good way for your team to prioritize students who need extra help.

### 17. Instructor Review: Foreign and Primary Keys (15 min)

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ How comfortable do you feel with primary and foreign keys? (Poll via Fist to Five, Slack, or Zoom)

* Assure students that we will cover the solution to help solidify their understanding. If questions remain, remind them to use office hours to get extra help!

* Use the prompts and talking points (🔑) below to review the following key points:

  * ✔️ `PRIMARY KEY`

  * ✔️ `FOREIGN KEY`

  * ✔️ `REFERENCES`

* Open `20-Stu_Foreign-Primary-Key/db/schema.sql;` in your IDE and explain the following: 

  * 🔑 We set the primary key of our customers table to the id to provide a unique identifier we can reference in another table. 

    ```sql
    CREATE TABLE customers (
      id INT NOT NULL,
      first_name VARCHAR(30),
      last_name VARCHAR(30),
      PRIMARY KEY (id)
    );
    ```

  * 🔑 Then, in the table where we want to reference the data, we add a column that will hold the values of the customers id.

    ```sql
    customer_id INT,
    ```

  * 🔑 We set the column that references data from another table as the foreign key. 

    ```sql
    FOREIGN KEY (customer_id)
    ```

  * 🔑 We use `REFERENCES` to define the relationship and describe what we want to happen if the parent data is no longer available.

    ```sql
    REFERENCES customers(id)
    ON DELETE SET NULL
    ```

* Navigate to `20-Stu_Foreign-Primary-Key/Solved/db` in your command line and enter `mysql -uroot -p` to enter the MySQL Shell to demonstrate the following:

  * To execute our schema and seed our data, we use the `SOURCE` command.

    ```sql
    SOURCE schema.sql;
    SOURCE seeds.sql;
    ``` 

  * We use `DESCRIBE` to test if our primary key and foreign key was added to the table. The foreign key will be shown as `MUL`, which is short for 'multiple' and means unlike the primary key, it does not need to be unique.

    ```sql
    DESCRIBE customers;
    DESCRIBE customer_order;
    ```

* Ask the class the following questions (☝️) and call on students for the answers (🙋):

  * ☝️ Why is it important that a primary key is unique? 

  * 🙋 We use primary keys to identify individual rows of data. Making sure the primary key is unique will ensure that that we have a way to access that row -- and only that row -- of data. 

  * ☝️ What can we do if we don't completely understand this?

  * 🙋 We can refer to supplemental material, read the [MySQL documentation on Primary Keys](https://dev.mysql.com/doc/refman/5.6/en/constraint-primary-key.html), [MySQL documentation on Foreign Keys](https://dev.mysql.com/doc/refman/5.6/en/create-table-foreign-keys.html),and stick around for office hours to ask for help.

* Answer any questions before ending the class.

### 18. END (0 min)

How did today’s lesson go? Your feedback is important. Please take 5 minutes to complete this [anonymous survey](https://forms.gle/RfcVyXiMmZQut6aJ6).

---
© 2021 Trilogy Education Services, LLC, a 2U, Inc. brand. Confidential and Proprietary. All Rights Reserved.
