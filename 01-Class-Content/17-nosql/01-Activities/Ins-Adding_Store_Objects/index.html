<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Adding Store Data</title>
  </head>

  <body>
    <script>
      var request = indexedDB.open("todo", 1);

      request.onerror = function(event) {
        console.log(request.errorCode);
      };

      request.onupgradeneeded = function(event) {
        var db = event.target.result;
        db.createObjectStore("todo", { autoIncrement: true });

        var objectStore = request.transaction.objectStore("todo");
        objectStore.createIndex("timestamp", "timestamp");
      };

      request.onsuccess = function(event) {
        var db = event.target.result;

        var transaction = db.transaction(["todo"], "readwrite");
        var store = transaction.objectStore("todo");

        var todos = [
          {
            id: "01",
            text: "Learn Indexed"
          },
          {
            id: "02",
            text: "Understand Cursors"
          }
        ];

        store.add(todos);
      };
 
      var db = event.target.result;
      console.log(db);
      var transaction = db.transaction(["todo"], "readonly");
      var objectStore = transaction.objectStore("todo");

      objectStore.openCursor().onsuccess = function(event) {
        var cursor = event.target.result;
        if (cursor) {
          console.log(cursor.value.text);
          cursor.continue();
        } 
      };
    </script>
  </body>
</html>
